Version 4
SHEET 1 3964 3484
WIRE 432 -528 432 -560
WIRE 528 -528 432 -528
WIRE 1088 -528 1088 -560
WIRE 1088 -528 992 -528
WIRE 1184 -528 1088 -528
WIRE 800 -512 800 -544
WIRE 2064 -512 1808 -512
WIRE 2224 -512 2160 -512
WIRE 2288 -512 2224 -512
WIRE 2064 -464 2064 -480
WIRE 2160 -464 2160 -480
WIRE 2160 -464 2064 -464
WIRE 2368 -464 2368 -512
WIRE 2368 -464 2160 -464
WIRE 2160 -448 2160 -464
WIRE 432 -432 432 -448
WIRE 1088 -432 1088 -448
WIRE 528 -416 528 -528
WIRE 1184 -416 1184 -528
WIRE 800 -400 800 -448
WIRE 864 -400 800 -400
WIRE 672 -352 672 -368
WIRE 800 -352 800 -400
WIRE 432 -336 432 -352
WIRE 528 -336 528 -352
WIRE 528 -336 432 -336
WIRE 1088 -336 1088 -352
WIRE 1184 -336 1184 -352
WIRE 1184 -336 1088 -336
WIRE 208 -256 16 -256
WIRE 240 -256 208 -256
WIRE 432 -256 432 -336
WIRE 432 -256 384 -256
WIRE 480 -256 432 -256
WIRE 576 -256 480 -256
WIRE 672 -256 672 -272
WIRE 672 -256 640 -256
WIRE 800 -256 800 -272
WIRE 800 -256 672 -256
WIRE 1088 -240 1088 -256
WIRE 672 -224 672 -256
WIRE 800 -224 800 -256
WIRE 1184 -224 1184 -336
WIRE 992 -192 992 -528
WIRE 1312 -192 1312 -224
WIRE 2064 -176 1808 -176
WIRE 2240 -176 2160 -176
WIRE 2304 -176 2240 -176
WIRE 432 -160 432 -256
WIRE 1088 -144 1088 -160
WIRE 1184 -144 1184 -160
WIRE 1184 -144 1088 -144
WIRE 2064 -128 2064 -144
WIRE 2160 -128 2160 -144
WIRE 2160 -128 2064 -128
WIRE 2384 -128 2384 -176
WIRE 2384 -128 2160 -128
WIRE -176 -112 -272 -112
WIRE -144 -112 -176 -112
WIRE -64 -112 -144 -112
WIRE 64 -112 16 -112
WIRE 208 -112 208 -256
WIRE 208 -112 128 -112
WIRE 368 -112 208 -112
WIRE 672 -112 672 -144
WIRE 800 -112 800 -144
WIRE -272 -96 -272 -112
WIRE 2160 -96 2160 -128
WIRE 1088 -80 1088 -144
WIRE 1216 -80 1088 -80
WIRE 1312 -80 1312 -112
WIRE 1312 -80 1280 -80
WIRE 1376 -80 1312 -80
WIRE 1504 -80 1456 -80
WIRE 1088 -64 1088 -80
WIRE -144 -48 -144 -112
WIRE 208 -32 208 -112
WIRE 432 -32 432 -64
WIRE 800 -16 800 -48
WIRE 992 -16 992 -112
WIRE 992 -16 800 -16
WIRE 1024 -16 992 -16
WIRE 2160 -16 2080 -16
WIRE 2848 -16 2160 -16
WIRE 2160 0 2160 -16
WIRE 800 16 800 -16
WIRE 1088 64 1088 32
WIRE 208 80 208 48
WIRE 2160 80 2160 64
WIRE 2160 112 2160 80
WIRE 800 128 800 80
WIRE -272 160 -272 -16
WIRE -144 160 -144 32
WIRE -144 160 -272 160
WIRE -272 192 -272 160
WIRE 2080 208 2080 -16
WIRE 2160 224 2128 224
WIRE 2240 224 2192 224
WIRE 2848 224 2848 -16
WIRE 3008 224 2896 224
WIRE 2896 240 2896 224
WIRE 2192 272 2192 224
WIRE 2192 272 2128 272
WIRE 2160 304 2160 224
WIRE 2240 304 2160 304
WIRE 1840 320 1808 320
WIRE 2080 320 2080 288
WIRE 2080 320 1840 320
WIRE 2896 320 2896 288
WIRE 3008 320 3008 304
WIRE 3008 320 2896 320
WIRE 2240 336 2240 304
WIRE 3008 336 3008 320
WIRE 2080 384 2080 320
WIRE 2848 384 2848 304
WIRE 2848 384 2080 384
WIRE 1840 448 1840 400
FLAG -272 192 0
FLAG -176 -112 IN
FLAG 2160 -448 0
FLAG 2160 -96 0
FLAG 2160 112 0
FLAG 2240 -176 SLOW_PAD
FLAG 2224 -512 FAST_PAD
FLAG 1808 320 DISCHARGE
FLAG 1808 -176 SLOW
FLAG 1808 -512 FAST
FLAG 432 -32 0
FLAG 208 80 V4
FLAG -208 -416 0
FLAG -208 -496 V4
FLAG 480 -192 0
FLAG 432 -560 V4
FLAG 672 -368 V4
FLAG 864 -400 FAST
FLAG 800 -544 VTERM
FLAG -96 -416 0
FLAG -96 -496 VTERM
FLAG 800 128 0
FLAG 1088 64 0
FLAG 1088 -560 V4
FLAG 1312 -224 VTERM
FLAG 1504 -80 SLOW
FLAG -64 -256 DISCHARGE
FLAG 672 -112 0
FLAG 1840 448 0
FLAG 2240 336 0
FLAG 3008 336 0
SYMBOL res 32 -128 R90
WINDOW 0 -1 66 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 820R
SYMBOL res -160 -64 R0
WINDOW 3 40 87 Left 2
SYMATTR Value 53.6R
SYMATTR InstName R25
SYMBOL tline 2112 -160 R0
WINDOW 3 -1 -91 Top 2
SYMATTR Value Td=.3n Z0=50
SYMATTR InstName T1
SYMBOL sw 2080 192 M0
WINDOW 3 42 65 Left 2
SYMATTR Value SwitchFast
SYMATTR InstName S1
SYMBOL res 2288 -160 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 100k
SYMBOL tline 2112 -496 R0
WINDOW 3 -1 -91 Top 2
SYMATTR Value Td=.3n Z0=50
SYMATTR InstName T2
SYMBOL bv 2240 208 R0
SYMATTR InstName B1
SYMATTR Value V=delay(V(FAST_PAD),{delay})
SYMBOL res 2384 -528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 100k
SYMBOL cap 128 -128 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C257
SYMATTR Value 220n
SYMBOL npn 368 -160 R0
SYMATTR InstName Q1
SYMATTR Value BFS520
SYMATTR Prefix X
SYMBOL res 32 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 12k
SYMBOL res 192 -48 R0
SYMATTR InstName R26
SYMATTR Value 10k
SYMBOL voltage -208 -512 R0
SYMATTR InstName V1
SYMATTR Value 4
SYMBOL res 336 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 680
SYMBOL cap 384 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C254
SYMATTR Value 100n
SYMBOL cap 464 -256 R0
WINDOW 0 42 20 Left 2
WINDOW 3 42 50 Left 2
SYMATTR InstName C258
SYMATTR Value 2.7p
SYMBOL cap 640 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C255
SYMATTR Value 100n
SYMBOL res 656 -368 R0
SYMATTR InstName R18
SYMATTR Value 200k
SYMBOL res 784 -368 R0
SYMATTR InstName R19
SYMATTR Value 220
SYMBOL diode 816 -448 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMATTR Prefix X
SYMBOL voltage -96 -512 R0
SYMATTR InstName V2
SYMATTR Value {vterm}
SYMBOL res 784 -240 R0
SYMATTR InstName R22
SYMATTR Value 300
SYMBOL cap 784 -112 R0
SYMATTR InstName C259
SYMATTR Value 100n
SYMBOL cap 784 16 R0
SYMATTR InstName C262
SYMATTR Value 10n
SYMBOL npn 1024 -64 R0
SYMATTR InstName Q2
SYMATTR Value BFP740F
SYMATTR Prefix X
SYMBOL ind 1072 -256 R0
SYMATTR InstName L7
SYMATTR Value 330µ
SYMBOL res 976 -208 R0
SYMATTR InstName R24
SYMATTR Value 62k
SYMBOL cap 1280 -96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C260
SYMATTR Value 100n
SYMBOL res 1296 -208 R0
SYMATTR InstName R122
SYMATTR Value 220
SYMBOL res 1472 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R123
SYMATTR Value 220
SYMBOL res 1072 -352 R0
SYMATTR InstName L7R
SYMATTR Value 13
SYMBOL cap 1168 -224 R0
SYMATTR InstName L7C
SYMATTR Value 0.2p
SYMBOL ind 1072 -448 R0
SYMATTR InstName L6
SYMATTR Value 330µ
SYMBOL res 1072 -544 R0
SYMATTR InstName L6R
SYMATTR Value 13
SYMBOL cap 1168 -416 R0
SYMATTR InstName L6C
SYMATTR Value 0.2p
SYMBOL ind 416 -448 R0
SYMATTR InstName L4
SYMATTR Value 330µ
SYMBOL res 416 -544 R0
SYMATTR InstName L4R
SYMATTR Value 13
SYMBOL cap 512 -416 R0
SYMATTR InstName L4C
SYMATTR Value 0.2p
SYMBOL res 656 -240 R0
SYMATTR InstName R180
SYMATTR Value 3k
SYMBOL voltage 2160 -16 R0
SYMATTR InstName V3
SYMATTR Value 3.5
SYMBOL res 1824 304 R0
SYMATTR InstName R1
SYMATTR Value 200
SYMBOL sw 2848 208 M0
WINDOW 3 42 65 Left 2
SYMATTR Value SwitchSlow
SYMATTR InstName S2
SYMBOL bv 3008 208 R0
SYMATTR InstName B2
SYMATTR Value V=delay(V(SLOW_PAD),{delay})
SYMBOL current -272 -96 R0
WINDOW 3 -592 330 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL(0n 0 4n 0 +{risetime/0.8} {amplitude/50} +{falltime/0.8} 0)
SYMATTR InstName I1
TEXT -864 304 Left 2 !.tran 0 {simuduration} 0s 2E-12
TEXT 2032 432 Left 2 !.model SwitchFast SW(Ron=1 Roff=1e6 Vt={thresh_fast} Vh=.01 Lser=.0 Vser=.0)
TEXT -848 -392 Left 2 !.include BFS520.lib
TEXT -848 -360 Left 2 !.include 1N4148.lib
TEXT -848 -328 Left 2 !.include BFP740F.lib
TEXT -856 -72 Left 2 !.param amplitude=2000m
TEXT -848 -248 Left 2 !;.step param thresh_slow_rel list 20m 25m
TEXT -856 96 Left 2 !.param thresh_fast={thresh_fast_rel+57.3087m}
TEXT -856 48 Left 2 !.param vterm=2.895
TEXT 1448 -352 Left 1 !.MEASURE TRAN ToT_Slow TRIG V(SLOW_PAD) VAL = {thresh_slow} FALL=1 + TARG V(SLOW_PAD) VAL = {thresh_slow} RISE = 1
TEXT 1448 -328 Left 1 !.MEASURE TRAN inputcharge INTEG I(I1)
TEXT -856 120 Left 2 !.param thresh_slow={-thresh_slow_rel+2.8823}
TEXT -856 72 Left 2 !.param delay=25n
TEXT 2032 472 Left 2 !.model SwitchSlow SW(Ron=1 Roff=1e6 Vt={-thresh_slow} Vh=.01 Lser=.0 Vser=.0)
TEXT 1448 -376 Left 1 !.MEASURE TRAN ToT_Fast TRIG V(FAST_PAD) VAL = {thresh_fast} RISE=1 + TARG V(FAST_PAD) VAL = {thresh_fast} FALL = 1
TEXT -856 -120 Left 2 !.param thresh_fast_rel=20m
TEXT -856 -96 Left 2 !.param thresh_slow_rel=20m
TEXT -856 -48 Left 2 !.param risetime=1n
TEXT -856 -24 Left 2 !.param falltime=10n
TEXT -864 272 Left 2 !.param simuduration={15n+amplitude*23n/800m+(risetime+falltime)*15n/3n}
TEXT -848 -272 Left 2 !;.step param thresh_fast_rel list 20m 25m
TEXT -848 -224 Left 2 !.step param amplitude 200m 3500m 800m
TEXT -848 -200 Left 2 !.step param risetime list 1n 4n 8n
TEXT -848 -176 Left 2 !.step param falltime list 1n 4n 8n
LINE Normal 1632 464 1632 464 2
